"use strict";(globalThis.webpackChunk_ethdebug_format_web=globalThis.webpackChunk_ethdebug_format_web||[]).push([[5459],{97757(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"concepts/data-locations","title":"Data locations","description":"The EVM stores data in several distinct locations, each with different","source":"@site/docs/concepts/data-locations.mdx","sourceDirName":"concepts","slug":"/concepts/data-locations","permalink":"/format/pr-preview/pr-168/docs/concepts/data-locations","draft":false,"unlisted":false,"editUrl":"https://github.com/ethdebug/format/tree/main/packages/web/docs/concepts/data-locations.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Overview","permalink":"/format/pr-preview/pr-168/docs/concepts/"},"next":{"title":"Types","permalink":"/format/pr-preview/pr-168/docs/types/"}}');var r=n(31085),i=n(71184);const a={sidebar_position:2},l="Data locations",d={},c=[{value:"Storage",id:"storage",level:2},{value:"Memory",id:"memory",level:2},{value:"Stack",id:"stack",level:2},{value:"Calldata",id:"calldata",level:2},{value:"Returndata",id:"returndata",level:2},{value:"Code",id:"code",level:2},{value:"Transient storage",id:"transient-storage",level:2},{value:"Summary",id:"summary",level:2},{value:"Next steps",id:"next-steps",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"data-locations",children:"Data locations"})}),"\n",(0,r.jsx)(s.p,{children:"The EVM stores data in several distinct locations, each with different\ncharacteristics. Understanding these locations is essential for working with\nethdebug/format pointers."}),"\n",(0,r.jsx)(s.h2,{id:"storage",children:"Storage"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Storage"})," is persistent data associated with a contract. It survives\ntransaction boundaries and is the primary place contracts store their state."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Persistent"})," \u2014 Values remain until explicitly changed"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Slot-based"})," \u2014 Organized into 32-byte slots numbered from 0"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Expensive"})," \u2014 Reading and writing storage costs significant gas"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Contract-specific"})," \u2014 Each contract has its own storage space"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Storage is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Contract state variables"}),"\n",(0,r.jsx)(s.li,{children:"Mapping contents (at computed slot locations)"}),"\n",(0,r.jsx)(s.li,{children:"Dynamic array contents (at computed slot locations)"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, storage locations use ",(0,r.jsx)(s.code,{children:'"location": "storage"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"memory",children:"Memory"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Memory"})," is temporary data that exists only during a single transaction's\nexecution. It's cleared between calls."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Temporary"})," \u2014 Cleared after each external call returns"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Byte-addressable"})," \u2014 Accessed by byte offset, not slots"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Linear"})," \u2014 Grows as needed, starting from offset 0"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cheaper than storage"})," \u2014 But costs gas to expand"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Memory is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Function arguments for external calls"}),"\n",(0,r.jsx)(s.li,{children:"Return data being prepared"}),"\n",(0,r.jsx)(s.li,{children:"Temporary variables and intermediate values"}),"\n",(0,r.jsx)(s.li,{children:"Dynamic data being constructed"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, memory locations use ",(0,r.jsx)(s.code,{children:'"location": "memory"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"stack",children:"Stack"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"The stack"})," is where the EVM performs computations. It holds operands and\nintermediate results."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"256-bit words"})," \u2014 Each stack item is 32 bytes"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Limited depth"})," \u2014 Maximum 1024 items"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"LIFO"})," \u2014 Last in, first out access pattern"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Ephemeral"})," \u2014 Contents change constantly during execution"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"The stack is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Function arguments (for internal calls)"}),"\n",(0,r.jsx)(s.li,{children:"Local variables (in some cases)"}),"\n",(0,r.jsx)(s.li,{children:"Intermediate computation results"}),"\n",(0,r.jsx)(s.li,{children:"Return addresses"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, stack locations use ",(0,r.jsx)(s.code,{children:'"location": "stack"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"calldata",children:"Calldata"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Calldata"})," is the read-only input data sent to a contract when it's called."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Read-only"})," \u2014 Cannot be modified during execution"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Byte-addressable"})," \u2014 Accessed by byte offset"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Transaction-specific"})," \u2014 Contains the call's input parameters"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cheap to read"})," \u2014 Cheaper than memory or storage reads"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Calldata is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Function selector (first 4 bytes)"}),"\n",(0,r.jsx)(s.li,{children:"ABI-encoded function arguments"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, calldata locations use ",(0,r.jsx)(s.code,{children:'"location": "calldata"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"returndata",children:"Returndata"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Returndata"})," is the output from the most recent external call."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Read-only"})," \u2014 Set by called contract, read by caller"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Replaced on each call"})," \u2014 Each external call overwrites previous\nreturndata"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Byte-addressable"})," \u2014 Accessed by byte offset"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Returndata is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Return values from external function calls"}),"\n",(0,r.jsx)(s.li,{children:"Revert reasons (when calls fail)"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, returndata locations use ",(0,r.jsx)(s.code,{children:'"location": "returndata"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"code",children:"Code"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Code"})," refers to the contract's bytecode itself. Sometimes data is embedded\nin the bytecode."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Immutable"})," \u2014 Cannot change after deployment"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Byte-addressable"})," \u2014 Accessed by byte offset"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Code is where you find:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Immutable variables (in some compiler implementations)"}),"\n",(0,r.jsx)(s.li,{children:"Embedded constants"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, code locations use ",(0,r.jsx)(s.code,{children:'"location": "code"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"transient-storage",children:"Transient storage"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Transient storage"})," (EIP-1153) is storage that persists within a transaction\nbut is cleared afterward."]}),"\n",(0,r.jsx)(s.p,{children:"Key characteristics:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Transaction-scoped"})," \u2014 Persists across calls within a transaction"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cleared after transaction"})," \u2014 Does not persist to the next transaction"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Slot-based"})," \u2014 Like storage, organized into 32-byte slots"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cheaper than storage"})," \u2014 Lower gas costs for temporary data"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["In ethdebug/format, transient storage locations use\n",(0,r.jsx)(s.code,{children:'"location": "transient"'}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Location"}),(0,r.jsx)(s.th,{children:"Persistence"}),(0,r.jsx)(s.th,{children:"Addressing"}),(0,r.jsx)(s.th,{children:"Primary use"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Storage"}),(0,r.jsx)(s.td,{children:"Permanent"}),(0,r.jsx)(s.td,{children:"32-byte slots"}),(0,r.jsx)(s.td,{children:"Contract state"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Memory"}),(0,r.jsx)(s.td,{children:"Single call"}),(0,r.jsx)(s.td,{children:"Byte offset"}),(0,r.jsx)(s.td,{children:"Temporary data"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Stack"}),(0,r.jsx)(s.td,{children:"Instruction-level"}),(0,r.jsx)(s.td,{children:"Position index"}),(0,r.jsx)(s.td,{children:"Computation"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Calldata"}),(0,r.jsx)(s.td,{children:"Single call"}),(0,r.jsx)(s.td,{children:"Byte offset"}),(0,r.jsx)(s.td,{children:"Input parameters"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Returndata"}),(0,r.jsx)(s.td,{children:"Until next call"}),(0,r.jsx)(s.td,{children:"Byte offset"}),(0,r.jsx)(s.td,{children:"Call results"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Code"}),(0,r.jsx)(s.td,{children:"Permanent"}),(0,r.jsx)(s.td,{children:"Byte offset"}),(0,r.jsx)(s.td,{children:"Bytecode/immutables"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Transient"}),(0,r.jsx)(s.td,{children:"Single transaction"}),(0,r.jsx)(s.td,{children:"32-byte slots"}),(0,r.jsx)(s.td,{children:"Tx-scoped state"})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.a,{href:"/docs/pointers",children:"Pointers"})})," \u2014 Learn how ethdebug/format describes\nlocations in these data areas"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.a,{href:"/docs/pointers/regions",children:"Regions"})})," \u2014 Understand how regions combine\nlocation, offset, and length"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);