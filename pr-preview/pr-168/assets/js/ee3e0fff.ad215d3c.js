"use strict";(globalThis.webpackChunk_ethdebug_format_web=globalThis.webpackChunk_ethdebug_format_web||[]).push([[5679],{11648(e,t,n){n.r(t),n.d(t,{default:()=>p});n(14041);var r=n(84872),s=n.n(r),i=n(38397),a=n(73584),o=n(40665),c=n(66010),h=n(77709),l=n(31085);function d({schemaWithoutUnnecessaryComposition:e,unnecessaryCompositionKeyword:t,unnecessarilyComposedSchema:n}){const r=(0,i.useJSVOptionsContext)(),{schemaIndex:s}=(0,a.wQ)(),d=n,m=e,{documentation:u,semantics:f}=function(e){if("boolean"==typeof e)return{documentation:{},semantics:e};const{title:t,description:n,examples:r,default:s,[a._K]:i,...o}=e,c=Object.entries({title:t,description:n,examples:r,default:s}).filter((e=>void 0!==e[1])).map((([e,t])=>({[e]:t}))).reduce(((e,t)=>({...e,...t})),{});return{documentation:c,semantics:o}}(m);if(0===Object.keys(f).length||1===Object.keys(f).length&&"type"in f&&"object"==typeof d&&"type"in d&&("string"==typeof f.type&&f.type===d.type||f.type instanceof Array&&d.type instanceof Array&&f.type.length===d.type.length&&f.type.every((e=>d.type.includes(e))))){if(1===Object.keys(u).length&&"title"in u)return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(i.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,l.jsx)(p,{schema:n})})});const{description:e}=u;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.QualifierMessages,{schema:u,options:r}),e&&(0,l.jsx)(h.CreateDescription,{description:e}),(0,l.jsx)("hr",{}),(0,l.jsx)(i.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,l.jsx)(p,{schema:n})})]})}const{[a._K]:x}=d;if(x&&x in s){const{href:e,title:t=`${x.startsWith("schema:")?x.slice(7):x} schema`}=s[x];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"badge badge--info",children:"extensions"}),"\xa0 This schema extends the ",(0,l.jsx)(o.A,{to:e,children:t}),".",(0,l.jsx)("p",{children:(0,l.jsx)(p,{schema:m})})]})}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"badge badge--info",children:"extensions"}),"\xa0 These extensions apply to the base schema below:",(0,l.jsx)("p",{children:(0,l.jsx)(p,{schema:m})}),(0,l.jsx)(Collapsible,{summary:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("strong",{children:(0,l.jsx)(c.GenerateFriendlyName,{schema:d})}),"\xa0",(0,l.jsx)("span",{className:"badge badge--info",children:"base schema"})]}),detailsProps:{open:!0},children:(0,l.jsx)(i.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,l.jsx)(p,{schema:n})})})]})}function p(e){const{level:t}=(0,i.useSchemaHierarchyContext)(),{schemaIndex:n}=(0,a.wQ)(),{schema:r,...c}=e,{[a._K]:h}=r;if(h&&h in n&&t>0){const{href:e,title:t=`${h.startsWith("schema:")?h.slice(7):h} schema`}=n[h];return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("p",{children:["See ",(0,l.jsx)(o.A,{to:e,children:t})," documentation."]})})}const p=function(e){if("boolean"==typeof e)return;const t=["allOf","oneOf","anyOf"].filter((t=>t in e&&1===(e[t]||[]).length));if(1!==t.length)return;const[n]=t,{[n]:r,...s}=e,[i]=r;return{unnecessarilyComposedSchema:i,unnecessaryCompositionKeyword:n,schemaWithoutUnnecessaryComposition:s}}(r);return p?(0,l.jsx)(d,{...p}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(s(),{schema:r,...c})})}},39396(e,t,n){n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"pointer/expression","title":"Expression syntax","description":"Pointer expressions operate on the domain of bytes representing unsigned","source":"@site/spec/pointer/expression.mdx","sourceDirName":"pointer","slug":"/pointer/expression","permalink":"/format/pr-preview/pr-168/spec/pointer/expression","draft":false,"unlisted":false,"editUrl":"https://github.com/ethdebug/format/tree/main/packages/web/spec/pointer/expression.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"docsSidebar","previous":{"title":"Templates","permalink":"/format/pr-preview/pr-168/spec/pointer/collection/templates"},"next":{"title":"Pointer templates","permalink":"/format/pr-preview/pr-168/spec/pointer/template"}}');var s=n(31085),i=n(71184),a=n(69436);const o={sidebar_position:6},c="Expression syntax",h={},l=[{value:"Literal values",id:"literal-values",level:2},{value:"Variables",id:"variables",level:2},{value:"Arithmetic operations",id:"arithmetic-operations",level:2},{value:"Lookup region definition",id:"lookup-region-definition",level:2},{value:"Reading from the EVM",id:"reading-from-the-evm",level:2},{value:"Keccak256 hashes",id:"keccak256-hashes",level:2},{value:"Bytes concatenation",id:"bytes-concatenation",level:2},{value:"Resize operations",id:"resize-operations",level:2},{value:"Region references",id:"region-references",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"expression-syntax",children:"Expression syntax"})}),"\n",(0,s.jsx)(t.p,{children:"Pointer expressions operate on the domain of bytes representing unsigned\nintegers."}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"}}),"\n",(0,s.jsx)(t.h2,{id:"literal-values",children:"Literal values"}),"\n",(0,s.jsx)(t.p,{children:"An expression can be a literal value."}),"\n",(0,s.jsxs)(t.p,{children:["Literal values ",(0,s.jsx)(t.strong,{children:"must"})," be represented either as JSON numbers or as\n",(0,s.jsx)(t.code,{children:"0x"}),"-prefixed hexadecimal strings. Hexadecimal strings always represent a\nliteral string of bytes."]}),"\n",(0,s.jsx)(t.p,{children:"For convenience, this schema does not restrict hexadecimal string\nrepresentations to those that specify an even-number of digits (i.e., those\nthat specify complete byte pairs); odd numbers of hexadecimal digits are fine."}),"\n",(0,s.jsxs)(t.p,{children:["Hexadecimal string representations ",(0,s.jsx)(t.strong,{children:"may"})," omit leading zeroes; values are\nassumed to be left-padded to the bytes width appropriate for the context."]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Literal"}),"\n",(0,s.jsx)(t.h2,{id:"variables",children:"Variables"}),"\n",(0,s.jsx)(t.p,{children:"An expression can be a string value equal to the identifier for a known\nscalar variable introduced by some pointer representation."}),"\n",(0,s.jsxs)(t.p,{children:["For an example where scalar variables may appear, see the\n",(0,s.jsx)(t.a,{href:"/spec/pointer/collection/list",children:"List collection schema"}),"."]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Variable"}),"\n",(0,s.jsx)(t.h2,{id:"arithmetic-operations",children:"Arithmetic operations"}),"\n",(0,s.jsxs)(t.p,{children:["An expression can be an object of the form ",(0,s.jsx)(t.code,{children:"{ <op>: [...] }"}),", where ",(0,s.jsx)(t.code,{children:"<op>"}),"\ndenotes an arithmetic operation."]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Arithmetic"}),"\n",(0,s.jsx)(t.h2,{id:"lookup-region-definition",children:"Lookup region definition"}),"\n",(0,s.jsxs)(t.p,{children:["An expression can reference properties defined for a particular region, such as\nanother region's ",(0,s.jsx)(t.code,{children:'"offset"'})," or ",(0,s.jsx)(t.code,{children:'"length"'}),". Such expressions resolve to the\nsame value as the expression specified for that corresponding property."]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Lookup"}),"\n",(0,s.jsx)(t.h2,{id:"reading-from-the-evm",children:"Reading from the EVM"}),"\n",(0,s.jsxs)(t.p,{children:["An expression can be an object of the form ",(0,s.jsx)(t.code,{children:'{ "$read": "<region>" }'}),", where\n",(0,s.jsx)(t.code,{children:"<region>"})," references a particular region defined in some root pointer."]}),"\n",(0,s.jsx)(t.p,{children:"The value of such an expression is the concatenation of bytes present in the\nrunning machine state that correspond to the bytes addressed by the referenced\nregion."}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Read"}),"\n",(0,s.jsx)(t.h2,{id:"keccak256-hashes",children:"Keccak256 hashes"}),"\n",(0,s.jsxs)(t.p,{children:["An expression can be an object of form ",(0,s.jsx)(t.code,{children:'{ "$keccak256": [...] }'}),", indicating\nthat the value of the expression is a Solidity-style, tightly-packed keccak256\nhash of the concatenation of bytes specified by the list."]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Keccak256"}),"\n",(0,s.jsx)(t.h2,{id:"bytes-concatenation",children:"Bytes concatenation"}),"\n",(0,s.jsxs)(t.p,{children:["An expression can be an object of form ",(0,s.jsx)(t.code,{children:'{ "$concat": [...] }'}),", indicating\nthat the value of the expression is the concatenation of bytes from each\nvalue in the list. The byte width of each operand is preserved; no padding\nis added or removed between operands."]}),"\n",(0,s.jsx)(t.p,{children:"This is useful for building composite byte sequences, for example when\nconstructing storage slot keys or preparing data for hashing."}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Concat"}),"\n",(0,s.jsx)(t.h2,{id:"resize-operations",children:"Resize operations"}),"\n",(0,s.jsx)(t.p,{children:"In certain situations, e.g. keccak256 hashes, it's crucially important to be\nable to express the bytes width of particular expression values. This schema\nprovides primitives to allow specifying an explicit bytes width for a\nparticular sub-expression."}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Resize"}),"\n",(0,s.jsx)(t.h2,{id:"region-references",children:"Region references"}),"\n",(0,s.jsxs)(t.p,{children:["Regions can be referenced either by name (which ",(0,s.jsx)(t.strong,{children:"must"})," be a defined region),\nor by use of the literal string value ",(0,s.jsx)(t.code,{children:'"$this"'})," (which indicates that the\nreferenced region is the region containing the expression itself)."]}),"\n",(0,s.jsxs)(t.p,{children:["In cases where an expression is used outside the context of a particular\nregion definition, the use of ",(0,s.jsx)(t.code,{children:'"$this"'})," is ",(0,s.jsx)(t.strong,{children:"prohibited"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Individual properties ",(0,s.jsx)(t.strong,{children:"may not"})," be defined with any reference to themselves.\nProperties also ",(0,s.jsx)(t.strong,{children:"may not"})," be defined in terms of mutual reference to each\nother. ",(0,s.jsx)("small",{children:"(Don't make this harder than it has to be.)"})]}),"\n",(0,s.jsx)(a.A,{schema:{id:"schema:ethdebug/format/pointer/expression"},pointer:"#/$defs/Reference"})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},59878(e,t,n){n.r(t),n.d(t,{default:()=>f});n(14041);var r=n(60728),s=n.n(r),i=n(53263),a=n(73580),o=n(38397),c=n(32049),h=n(31085);function l({propertyName:e,schemasByConst:t}){const{jsonPointer:n,level:r}=(0,o.useSchemaHierarchyContext)();return(0,h.jsxs)("div",{children:[(0,h.jsx)("hr",{}),(0,h.jsx)("span",{className:"badge badge--info",children:"polymorphic discriminator"}),"\xa0 The value of the ",(0,h.jsx)("strong",{children:e})," field determines which sub-schema applies:",(0,h.jsx)(i.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,h.jsx)(a.default,{label:e,value:e,children:(0,h.jsx)(o.SchemaHierarchyContextProvider,{value:{level:r+1,jsonPointer:`${n}/allOf/${s}/then`},children:(0,h.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}function d({propertyNames:e,schemasByPropertyName:t}){const{jsonPointer:n,level:r}=(0,o.useSchemaHierarchyContext)();return(0,h.jsxs)("div",{children:[(0,h.jsx)("hr",{}),(0,h.jsx)("span",{className:"badge badge--info",children:"mutually-exclusive required properties"}),"\xa0 This object must specify exactly one of the following:",(0,h.jsx)("ul",{children:e.map(((e,t)=>(0,h.jsx)("li",{children:(0,h.jsx)("code",{children:e})},t)))}),"Depending on which required property is used, one of the following sub-schemas applies:",(0,h.jsx)(i.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,h.jsx)(a.default,{label:"title"in t&&"string"==typeof t.title&&t.title||e,value:e,children:(0,h.jsx)(o.SchemaHierarchyContextProvider,{value:{level:r+1,jsonPointer:`${n}/allOf/${s+1}/then`},children:(0,h.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}function p({propertyNames:e,schemasByPropertyName:t}){const{jsonPointer:n,level:r}=(0,o.useSchemaHierarchyContext)();return(0,h.jsxs)("div",{children:[(0,h.jsx)("hr",{}),(0,h.jsx)("span",{className:"badge badge--info",children:"independently-inclusive required properties"}),"\xa0 This object may specify any of the following:",(0,h.jsx)("ul",{children:e.map(((e,t)=>(0,h.jsx)("li",{children:(0,h.jsx)("code",{children:e})},t)))}),"Depending on which required properties are used, the following corresponding sub-schemas may apply:",(0,h.jsx)(i.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,h.jsx)(a.default,{label:"title"in t&&"string"==typeof t.title&&t.title||e,value:e,children:(0,h.jsx)(o.SchemaHierarchyContextProvider,{value:{level:r+1,jsonPointer:`${n}/allOf/${s+1}/then`},children:(0,h.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}const m=e=>"boolean"!=typeof e&&"if"in e&&"then"in e,u=e=>"boolean"!=typeof e&&"required"in e&&1===e.required?.length;function f(e){const{schema:t}=e,n=function(e){const{allOf:t}=e;if(!t.every((e=>{if("boolean"==typeof e)return!1;const{title:t,description:n,if:r,then:s,...i}=e;return!!r&&!!s&&0===Object.keys(i).length})))return;if(!t.every((e=>{const{if:t}=e;if("boolean"==typeof t||!("properties"in t)||!t.properties)return!1;const n=t.properties;if(1!==Object.keys(n).length)return!1;const r=n[Object.keys(n)[0]];return"object"==typeof r&&"const"in r&&"string"==typeof r.const&&!!r.const})))return;const n=Object.keys(t[0].if.properties)[0],r=t.map((({if:e,then:t},r)=>({[e.properties[n].const]:{schema:t,index:r}}))).reduce(((e,t)=>({...e,...t})),{});return Object.keys(r).length===t.length?{propertyName:n,schemasByConst:r}:void 0}(t);if(n)return(0,h.jsx)(l,{...n});const r=function(e){const{allOf:t}=e,[n,...r]=t;if("boolean"==typeof n||!("oneOf"in n))return;const{oneOf:s}=n;if(!s||!s.every((e=>"object"==typeof e&&"required"in e&&e.required instanceof Array&&1===e.required.length)))return;const i=s.map((({required:[e]})=>e));if(r.length!==i.length)return;if(!r.every((e=>{if("boolean"==typeof e)return!1;const{title:t,description:n,if:r,then:s,...i}=e;return!!r&&!!s&&0===Object.keys(i).length})))return;if(!r.every((e=>{const{if:t}=e;if("boolean"==typeof t||!("required"in t))return!1;const{required:n}=t;if(!n||1!==n.length)return!1;const[r]=n;return"string"==typeof r&&!!r})))return;return{propertyNames:i,schemasByPropertyName:r.map((({if:{required:[e]},then:t},n)=>({[e]:{schema:t,index:n}}))).reduce(((e,t)=>({...e,...t})),{})}}(t);if(r)return(0,h.jsx)(d,{...r});const i=function(e){const{allOf:t}=e;if(!t.every(m))return;const n=t.map((({if:e})=>e));if(!n.every(u))return;const r=[...new Set(n.map((({required:[e]})=>e)))];return r.length!==n.length?void console.debug("property names are not unique"):{propertyNames:r,schemasByPropertyName:t.map((({if:{required:[e]},then:t},n)=>({[e]:{schema:t,index:n}}))).reduce(((e,t)=>({...e,...t})),{})}}(t);return i?(0,h.jsx)(p,{...i}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(s(),{...e})})}},69436(e,t,n){n.d(t,{A:()=>w});var r=n(14041),s=n(54648),i=n.n(s),a=n(54034),o=n.n(a),c=n(53263),h=n(73580),l=n(31917);const d={...{"schema:ethdebug/format/type/base":{title:"ethdebug/format/type/base schema",href:"/spec/type/base"},"schema:ethdebug/format/type/base#/$defs/TypeWrapper":{title:"Base type wrapper schema",href:"/spec/type/base#base-type-wrapper-schema"},"schema:ethdebug/format/type/wrapper":{title:"Type wrapper schema",href:"/spec/type/concepts#type-wrapper-schema"},"schema:ethdebug/format/type/reference":{title:"Type reference schema",href:"/spec/type/concepts#type-reference-schema"},"schema:ethdebug/format/type/definition":{title:"Type definition schema",href:"/spec/type/concepts#type-definition-schema"},"schema:ethdebug/format/type":{href:"/spec/type"},"schema:ethdebug/format/type/elementary":{href:"/spec/type#elementary-type-schema"},"schema:ethdebug/format/type/complex":{href:"/spec/type#complex-type-schema"},...["uint","int","ufixed","fixed","bool","bytes","string","address","contract","enum"].map((e=>({[`schema:ethdebug/format/type/elementary/${e}`]:{href:`/spec/type/elementary/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),...["alias","tuple","array","mapping","struct","function"].map((e=>({[`schema:ethdebug/format/type/complex/${e}`]:{href:`/spec/type/complex/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/type/complex/function#/$defs/Parameters":{title:"Parameters schema",href:"/spec/type/complex/function#parameters-schema"}},...{"schema:ethdebug/format/pointer":{href:"/spec/pointer"},"schema:ethdebug/format/pointer/region":{href:"/spec/pointer/region"},"schema:ethdebug/format/pointer/region/base":{href:"/spec/pointer/region/base"},...["stack","memory","storage","calldata","returndata","transient","code"].map((e=>({[`schema:ethdebug/format/pointer/region/${e}`]:{href:`/spec/pointer/region/location/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),...["slice","segment"].map((e=>({[`schema:ethdebug/format/pointer/scheme/${e}`]:{href:`/spec/pointer/region/scheme/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/pointer/collection":{href:"/spec/pointer/collection"},...["group","list","conditional","scope","reference","templates"].map((e=>({[`schema:ethdebug/format/pointer/collection/${e}`]:{href:`/spec/pointer/collection/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/pointer/expression":{href:"/spec/pointer/expression"},"schema:ethdebug/format/pointer/template":{href:"/spec/pointer/template"},...Object.entries({Literal:{title:"Literal values schema",anchor:"#literal-values"},Variable:{title:"Variable expression schema",anchor:"#variables"},Arithmetic:{title:"Arithmetic operation expression schema",anchor:"#arithmetic-operations"},Lookup:{title:"Lookup expression schema",anchor:"#lookup-region-definition"},Read:{title:"Read expression schema",anchor:"#reading-from-the-evm"},Keccak256:{title:"Keccak256 hash expression schema",anchor:"#keccak256-hashes"},Concat:{title:"Bytes concatenation schema",anchor:"#bytes-concatenation"},Resize:{title:"Resize operation schema",anchor:"#resize-operations"},Reference:{title:"Region reference",anchor:"#region-references"}}).map((([e,{title:t,anchor:n}])=>({[`schema:ethdebug/format/pointer/expression#/$defs/${e}`]:{title:t,href:`/spec/pointer/expression${n}`}}))).reduce(((e,t)=>({...e,...t})),{})},...["value","hex","unsigned"].map((e=>({[`schema:ethdebug/format/data/${e}`]:{href:`/spec/data/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/materials/id":{title:"Identifier schema",href:"/spec/materials/id#identifier-schema"},"schema:ethdebug/format/materials/reference":{title:"Reference schema",href:"/spec/materials/id#reference-schema"},"schema:ethdebug/format/materials/compilation":{title:"Compilation schema",href:"/spec/materials/compilation"},"schema:ethdebug/format/materials/source":{title:"Source schema",href:"/spec/materials/source"},"schema:ethdebug/format/materials/source-range":{title:"Source range schema",href:"/spec/materials/source-range"},"schema:ethdebug/format/info":{title:"ethdebug/format/info",href:"/spec/info"},...{"schema:ethdebug/format/program":{href:"/spec/program"},"schema:ethdebug/format/program/instruction":{href:"/spec/program/instruction"},"schema:ethdebug/format/program/context":{href:"/spec/program/context"},...["code","variables","remark","pick","gather","frame"].map((e=>({[`schema:ethdebug/format/program/context/${e}`]:{href:`/spec/program/context/${e}`}}))).reduce(((e,t)=>({...e,...t})),{})},"schema:ethdebug/format/info":{href:"/spec/info"},"schema:ethdebug/format/info/resources":{href:"/spec/info/resources"}};var p=n(73584),m=n(87906),u=n(31085);function f(e){const{id:t,pointer:n,schema:r,yaml:s}=(0,l.hZ)(e),i=t?t.startsWith("schema:")?t.slice(7):t:void 0,a=i&&n?`${i}${n}`:i||void 0;return(0,u.jsxs)(c.default,{groupId:"schema-language",children:[(0,u.jsx)(h.default,{value:"yaml",label:"YAML",children:(0,u.jsx)(o(),{className:"schema-listing",language:"yaml",showLineNumbers:!0,title:a||"schema.yaml",children:s})}),(0,u.jsx)(h.default,{value:"json",label:"JSON",children:(0,u.jsx)(o(),{className:"schema-listing",language:"json",showLineNumbers:!0,title:a?`${a}`:"schema.json",children:JSON.stringify(r,void 0,2)})})]})}var x=n(86952),g=n(95500),y=n(75128),b=n.n(y),j=n(21805),v=n(77433),k=n.n(v);function $(e){const{schema:t}=(0,l.hZ)(e),{colorMode:n}=(0,g.G)(),s=t.examples?.[0]??{},i=(0,r.useRef)(null),a=(0,x.useMonaco)(),o=2,c=new(k())({schemas:Object.values(l.jo),allErrors:!0,strict:!1}),[h,d]=(0,r.useState)(s),[p,m]=(0,r.useState)(!1);function f(e){console.error(e)}return(0,r.useEffect)((()=>{p&&function(){const t=c.getSchema(e.schema.id);if(!t)return f("Unable to validate schema");const n=function(){try{return b().parse(h,void 0,{tabWidth:o})}catch{return{data:"",pointers:{}}}}();t(n.data);const r=(0,j.L)({schema:l.jo[e.schema.id],data:n.data,errors:t.errors});console.log(r,t.errors),function(e,t){const n=i.current?.getModel();if(!n||!a)return f("Unable to validate schema");const r=[];if(e)for(const[s,i]of Object.entries(e)){const e=i.path.replace("{base}","").replace(/\./g,"/"),n=t.pointers[e];let s=i.message.replace("{base}","").replace(/\./g,"/");"const"==i.context.errorType&&(s=`Expecting a constant value of "${i.context.allowedValue}"`),n&&s&&(r.push({startLineNumber:n.value.line+1,startColumn:n.value.column+1,endColumn:n.valueEnd.column+1,endLineNumber:n.valueEnd.line+1,message:s,severity:a.MarkerSeverity.Error}),n.key&&n.keyEnd&&r.push({startLineNumber:n.key.line+1,startColumn:n.key.column+1,endColumn:n.keyEnd.column+1,endLineNumber:n.keyEnd.line+1,message:s,severity:a.MarkerSeverity.Error}))}a.editor.setModelMarkers(n,"EthDebug",r)}(r,n)}()}),[h]),(0,u.jsx)("section",{className:"playground-container",children:(0,u.jsx)(x.default,{height:"50vh",language:"json",theme:"dark"==n?"vs-dark":"vs-light",defaultValue:JSON.stringify(s,void 0,o),onChange:function(e){m(!0),d(e)},onMount:function(e){i.current=e},options:{contextmenu:!1,autoIndent:"advanced",tabSize:o}})})}function w(e){const t=(0,l.hZ)(e),{id:n,rootSchema:r,yaml:s,pointer:a}=t,x=O(r,n||"");return(0,u.jsxs)(c.default,{children:[(0,u.jsx)(h.default,{value:"viewer",label:"Explore",children:(0,u.jsx)(p.fn.Provider,{value:{rootSchemaInfo:t,schemaIndex:d},children:(0,u.jsx)(i(),{schema:x,resolverOptions:{jsonPointer:a,resolvers:{schema:{resolve:e=>{const t=e.toString(),{schema:n}=(0,l.hZ)({schema:{id:t}});return O(n,t)}}}},viewerOptions:{showExamples:!0,ValueComponent:({value:e})=>["string","number","bigint","boolean"].includes(typeof e)?(0,u.jsx)("code",{children:e.toString()}):(0,u.jsx)(o(),{language:"json",children:`${JSON.stringify(e,void 0,2)}`}),DescriptionComponent:({description:e})=>(0,u.jsx)(m.oz,{children:e})}})})}),(0,u.jsx)(h.default,{value:"listing",label:"View source",children:(0,u.jsx)(f,{schema:e.schema,pointer:e.pointer})}),(0,u.jsx)(h.default,{value:"playground",label:"Playground",children:(0,u.jsx)($,{schema:e.schema,pointer:e.pointer})})]})}function O(e,t){return S(C(e),`${t}#`)}function S(e,t){return Array.isArray(e)?e.map(((e,n)=>S(e,`${t}/${n}`))):null!==e&&"object"==typeof e?Object.entries(e).reduce(((e,[n,r])=>(e[n]=S(r,`${t}/${n}`),e)),{[p._K]:t.endsWith("#")?t.slice(0,-1):t}):e}function C(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(C);if(1===Object.keys(e).length&&"$ref"in e)return e;const{$ref:t,...n}=e,r=Object.entries(n).reduce(((e,[t,n])=>(e[t]=C(n),e)),{});if(!t)return r;const s=["allOf","oneOf","anyOf"].find((t=>!(t in e)));if(!s)throw new Error(`Could not find available composition keyword in ${JSON.stringify(e)}`);return r[s]=[{$ref:t}],r}},73584(e,t,n){n.d(t,{_K:()=>a,fn:()=>s,wQ:()=>i});var r=n(14041);const s=(0,r.createContext)({schemaIndex:{}}),i=()=>(0,r.useContext)(s),a=Symbol("__$internalId")},99953(e,t,n){n.r(t),n.d(t,{default:()=>i});n(14041);var r=n(76947),s=n(31085);function i(e){const{schema:t}=e,n=void 0!==t.if,i=void 0!==t.dependentRequired,a=void 0!==t.dependentSchemas,o=void 0!==t.dependencies;return(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)(r.IfElseThen,{schema:t}),i&&(0,s.jsx)(r.DependentRequired,{schema:t}),a&&(0,s.jsx)(r.DependentSchemas,{schema:t}),o&&(0,s.jsx)(r.Dependencies,{schema:t})]})}}}]);