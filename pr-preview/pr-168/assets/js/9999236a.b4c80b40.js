"use strict";(globalThis.webpackChunk_ethdebug_format_web=globalThis.webpackChunk_ethdebug_format_web||[]).push([[9865],{11648(e,t,r){r.r(t),r.d(t,{default:()=>m});r(14041);var n=r(84872),s=r.n(n),a=r(38397),i=r(73584),o=r(40665),c=r(66010),l=r(77709),h=r(31085);function p({schemaWithoutUnnecessaryComposition:e,unnecessaryCompositionKeyword:t,unnecessarilyComposedSchema:r}){const n=(0,a.useJSVOptionsContext)(),{schemaIndex:s}=(0,i.wQ)(),p=r,d=e,{documentation:u,semantics:f}=function(e){if("boolean"==typeof e)return{documentation:{},semantics:e};const{title:t,description:r,examples:n,default:s,[i._K]:a,...o}=e,c=Object.entries({title:t,description:r,examples:n,default:s}).filter((e=>void 0!==e[1])).map((([e,t])=>({[e]:t}))).reduce(((e,t)=>({...e,...t})),{});return{documentation:c,semantics:o}}(d);if(0===Object.keys(f).length||1===Object.keys(f).length&&"type"in f&&"object"==typeof p&&"type"in p&&("string"==typeof f.type&&f.type===p.type||f.type instanceof Array&&p.type instanceof Array&&f.type.length===p.type.length&&f.type.every((e=>p.type.includes(e))))){if(1===Object.keys(u).length&&"title"in u)return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(a.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,h.jsx)(m,{schema:r})})});const{description:e}=u;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.QualifierMessages,{schema:u,options:n}),e&&(0,h.jsx)(l.CreateDescription,{description:e}),(0,h.jsx)("hr",{}),(0,h.jsx)(a.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,h.jsx)(m,{schema:r})})]})}const{[i._K]:y}=p;if(y&&y in s){const{href:e,title:t=`${y.startsWith("schema:")?y.slice(7):y} schema`}=s[y];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"badge badge--info",children:"extensions"}),"\xa0 This schema extends the ",(0,h.jsx)(o.A,{to:e,children:t}),".",(0,h.jsx)("p",{children:(0,h.jsx)(m,{schema:d})})]})}return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:"badge badge--info",children:"extensions"}),"\xa0 These extensions apply to the base schema below:",(0,h.jsx)("p",{children:(0,h.jsx)(m,{schema:d})}),(0,h.jsx)(Collapsible,{summary:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("strong",{children:(0,h.jsx)(c.GenerateFriendlyName,{schema:p})}),"\xa0",(0,h.jsx)("span",{className:"badge badge--info",children:"base schema"})]}),detailsProps:{open:!0},children:(0,h.jsx)(a.SchemaHierarchyComponent,{innerJsonPointer:`/${t}/0`,children:(0,h.jsx)(m,{schema:r})})})]})}function m(e){const{level:t}=(0,a.useSchemaHierarchyContext)(),{schemaIndex:r}=(0,i.wQ)(),{schema:n,...c}=e,{[i._K]:l}=n;if(l&&l in r&&t>0){const{href:e,title:t=`${l.startsWith("schema:")?l.slice(7):l} schema`}=r[l];return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("p",{children:["See ",(0,h.jsx)(o.A,{to:e,children:t})," documentation."]})})}const m=function(e){if("boolean"==typeof e)return;const t=["allOf","oneOf","anyOf"].filter((t=>t in e&&1===(e[t]||[]).length));if(1!==t.length)return;const[r]=t,{[r]:n,...s}=e,[a]=n;return{unnecessarilyComposedSchema:a,unnecessaryCompositionKeyword:r,schemaWithoutUnnecessaryComposition:s}}(n);return m?(0,h.jsx)(p,{...m}):(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(s(),{schema:n,...c})})}},59878(e,t,r){r.r(t),r.d(t,{default:()=>f});r(14041);var n=r(60728),s=r.n(n),a=r(53263),i=r(73580),o=r(38397),c=r(32049),l=r(31085);function h({propertyName:e,schemasByConst:t}){const{jsonPointer:r,level:n}=(0,o.useSchemaHierarchyContext)();return(0,l.jsxs)("div",{children:[(0,l.jsx)("hr",{}),(0,l.jsx)("span",{className:"badge badge--info",children:"polymorphic discriminator"}),"\xa0 The value of the ",(0,l.jsx)("strong",{children:e})," field determines which sub-schema applies:",(0,l.jsx)(a.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,l.jsx)(i.default,{label:e,value:e,children:(0,l.jsx)(o.SchemaHierarchyContextProvider,{value:{level:n+1,jsonPointer:`${r}/allOf/${s}/then`},children:(0,l.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}function p({propertyNames:e,schemasByPropertyName:t}){const{jsonPointer:r,level:n}=(0,o.useSchemaHierarchyContext)();return(0,l.jsxs)("div",{children:[(0,l.jsx)("hr",{}),(0,l.jsx)("span",{className:"badge badge--info",children:"mutually-exclusive required properties"}),"\xa0 This object must specify exactly one of the following:",(0,l.jsx)("ul",{children:e.map(((e,t)=>(0,l.jsx)("li",{children:(0,l.jsx)("code",{children:e})},t)))}),"Depending on which required property is used, one of the following sub-schemas applies:",(0,l.jsx)(a.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,l.jsx)(i.default,{label:"title"in t&&"string"==typeof t.title&&t.title||e,value:e,children:(0,l.jsx)(o.SchemaHierarchyContextProvider,{value:{level:n+1,jsonPointer:`${r}/allOf/${s+1}/then`},children:(0,l.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}function m({propertyNames:e,schemasByPropertyName:t}){const{jsonPointer:r,level:n}=(0,o.useSchemaHierarchyContext)();return(0,l.jsxs)("div",{children:[(0,l.jsx)("hr",{}),(0,l.jsx)("span",{className:"badge badge--info",children:"independently-inclusive required properties"}),"\xa0 This object may specify any of the following:",(0,l.jsx)("ul",{children:e.map(((e,t)=>(0,l.jsx)("li",{children:(0,l.jsx)("code",{children:e})},t)))}),"Depending on which required properties are used, the following corresponding sub-schemas may apply:",(0,l.jsx)(a.default,{children:Object.entries(t).map((([e,{schema:t,index:s}])=>(0,l.jsx)(i.default,{label:"title"in t&&"string"==typeof t.title&&t.title||e,value:e,children:(0,l.jsx)(o.SchemaHierarchyContextProvider,{value:{level:n+1,jsonPointer:`${r}/allOf/${s+1}/then`},children:(0,l.jsx)(c.CreateNodes,{schema:t})})},e)))})]})}const d=e=>"boolean"!=typeof e&&"if"in e&&"then"in e,u=e=>"boolean"!=typeof e&&"required"in e&&1===e.required?.length;function f(e){const{schema:t}=e,r=function(e){const{allOf:t}=e;if(!t.every((e=>{if("boolean"==typeof e)return!1;const{title:t,description:r,if:n,then:s,...a}=e;return!!n&&!!s&&0===Object.keys(a).length})))return;if(!t.every((e=>{const{if:t}=e;if("boolean"==typeof t||!("properties"in t)||!t.properties)return!1;const r=t.properties;if(1!==Object.keys(r).length)return!1;const n=r[Object.keys(r)[0]];return"object"==typeof n&&"const"in n&&"string"==typeof n.const&&!!n.const})))return;const r=Object.keys(t[0].if.properties)[0],n=t.map((({if:e,then:t},n)=>({[e.properties[r].const]:{schema:t,index:n}}))).reduce(((e,t)=>({...e,...t})),{});return Object.keys(n).length===t.length?{propertyName:r,schemasByConst:n}:void 0}(t);if(r)return(0,l.jsx)(h,{...r});const n=function(e){const{allOf:t}=e,[r,...n]=t;if("boolean"==typeof r||!("oneOf"in r))return;const{oneOf:s}=r;if(!s||!s.every((e=>"object"==typeof e&&"required"in e&&e.required instanceof Array&&1===e.required.length)))return;const a=s.map((({required:[e]})=>e));if(n.length!==a.length)return;if(!n.every((e=>{if("boolean"==typeof e)return!1;const{title:t,description:r,if:n,then:s,...a}=e;return!!n&&!!s&&0===Object.keys(a).length})))return;if(!n.every((e=>{const{if:t}=e;if("boolean"==typeof t||!("required"in t))return!1;const{required:r}=t;if(!r||1!==r.length)return!1;const[n]=r;return"string"==typeof n&&!!n})))return;return{propertyNames:a,schemasByPropertyName:n.map((({if:{required:[e]},then:t},r)=>({[e]:{schema:t,index:r}}))).reduce(((e,t)=>({...e,...t})),{})}}(t);if(n)return(0,l.jsx)(p,{...n});const a=function(e){const{allOf:t}=e;if(!t.every(d))return;const r=t.map((({if:e})=>e));if(!r.every(u))return;const n=[...new Set(r.map((({required:[e]})=>e)))];return n.length!==r.length?void console.debug("property names are not unique"):{propertyNames:n,schemasByPropertyName:t.map((({if:{required:[e]},then:t},r)=>({[e]:{schema:t,index:r}}))).reduce(((e,t)=>({...e,...t})),{})}}(t);return a?(0,l.jsx)(m,{...a}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(s(),{...e})})}},69186(e,t,r){r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"pointer/template","title":"Pointer templates","description":"This format provides the concept of a pointer template to allow","source":"@site/spec/pointer/template.mdx","sourceDirName":"pointer","slug":"/pointer/template","permalink":"/format/pr-preview/pr-168/spec/pointer/template","draft":false,"unlisted":false,"editUrl":"https://github.com/ethdebug/format/tree/main/packages/web/spec/pointer/template.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"Expression syntax","permalink":"/format/pr-preview/pr-168/spec/pointer/expression"},"next":{"title":"Overview","permalink":"/format/pr-preview/pr-168/spec/data/overview"}}');var s=r(31085),a=r(71184),i=r(69436);const o={sidebar_position:7},c="Pointer templates",l={},h=[];function p(e){const t={h1:"h1",header:"header",p:"p",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"pointer-templates",children:"Pointer templates"})}),"\n",(0,s.jsxs)(t.p,{children:["This format provides the concept of a ",(0,s.jsx)(t.strong,{children:"pointer template"})," to allow\ndeduplicating representations. Pointer templates are defined to specify the\nvariables they expect in scope and the pointer definition that uses those\nvariables."]}),"\n",(0,s.jsx)(i.A,{schema:{id:"schema:ethdebug/format/pointer/template"}})]})}function m(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},69436(e,t,r){r.d(t,{A:()=>O});var n=r(14041),s=r(54648),a=r.n(s),i=r(54034),o=r.n(i),c=r(53263),l=r(73580),h=r(31917);const p={...{"schema:ethdebug/format/type/base":{title:"ethdebug/format/type/base schema",href:"/spec/type/base"},"schema:ethdebug/format/type/base#/$defs/TypeWrapper":{title:"Base type wrapper schema",href:"/spec/type/base#base-type-wrapper-schema"},"schema:ethdebug/format/type/wrapper":{title:"Type wrapper schema",href:"/spec/type/concepts#type-wrapper-schema"},"schema:ethdebug/format/type/reference":{title:"Type reference schema",href:"/spec/type/concepts#type-reference-schema"},"schema:ethdebug/format/type/definition":{title:"Type definition schema",href:"/spec/type/concepts#type-definition-schema"},"schema:ethdebug/format/type":{href:"/spec/type"},"schema:ethdebug/format/type/elementary":{href:"/spec/type#elementary-type-schema"},"schema:ethdebug/format/type/complex":{href:"/spec/type#complex-type-schema"},...["uint","int","ufixed","fixed","bool","bytes","string","address","contract","enum"].map((e=>({[`schema:ethdebug/format/type/elementary/${e}`]:{href:`/spec/type/elementary/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),...["alias","tuple","array","mapping","struct","function"].map((e=>({[`schema:ethdebug/format/type/complex/${e}`]:{href:`/spec/type/complex/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/type/complex/function#/$defs/Parameters":{title:"Parameters schema",href:"/spec/type/complex/function#parameters-schema"}},...{"schema:ethdebug/format/pointer":{href:"/spec/pointer"},"schema:ethdebug/format/pointer/region":{href:"/spec/pointer/region"},"schema:ethdebug/format/pointer/region/base":{href:"/spec/pointer/region/base"},...["stack","memory","storage","calldata","returndata","transient","code"].map((e=>({[`schema:ethdebug/format/pointer/region/${e}`]:{href:`/spec/pointer/region/location/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),...["slice","segment"].map((e=>({[`schema:ethdebug/format/pointer/scheme/${e}`]:{href:`/spec/pointer/region/scheme/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/pointer/collection":{href:"/spec/pointer/collection"},...["group","list","conditional","scope","reference","templates"].map((e=>({[`schema:ethdebug/format/pointer/collection/${e}`]:{href:`/spec/pointer/collection/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/pointer/expression":{href:"/spec/pointer/expression"},"schema:ethdebug/format/pointer/template":{href:"/spec/pointer/template"},...Object.entries({Literal:{title:"Literal values schema",anchor:"#literal-values"},Variable:{title:"Variable expression schema",anchor:"#variables"},Arithmetic:{title:"Arithmetic operation expression schema",anchor:"#arithmetic-operations"},Lookup:{title:"Lookup expression schema",anchor:"#lookup-region-definition"},Read:{title:"Read expression schema",anchor:"#reading-from-the-evm"},Keccak256:{title:"Keccak256 hash expression schema",anchor:"#keccak256-hashes"},Concat:{title:"Bytes concatenation schema",anchor:"#bytes-concatenation"},Resize:{title:"Resize operation schema",anchor:"#resize-operations"},Reference:{title:"Region reference",anchor:"#region-references"}}).map((([e,{title:t,anchor:r}])=>({[`schema:ethdebug/format/pointer/expression#/$defs/${e}`]:{title:t,href:`/spec/pointer/expression${r}`}}))).reduce(((e,t)=>({...e,...t})),{})},...["value","hex","unsigned"].map((e=>({[`schema:ethdebug/format/data/${e}`]:{href:`/spec/data/${e}`}}))).reduce(((e,t)=>({...e,...t})),{}),"schema:ethdebug/format/materials/id":{title:"Identifier schema",href:"/spec/materials/id#identifier-schema"},"schema:ethdebug/format/materials/reference":{title:"Reference schema",href:"/spec/materials/id#reference-schema"},"schema:ethdebug/format/materials/compilation":{title:"Compilation schema",href:"/spec/materials/compilation"},"schema:ethdebug/format/materials/source":{title:"Source schema",href:"/spec/materials/source"},"schema:ethdebug/format/materials/source-range":{title:"Source range schema",href:"/spec/materials/source-range"},"schema:ethdebug/format/info":{title:"ethdebug/format/info",href:"/spec/info"},...{"schema:ethdebug/format/program":{href:"/spec/program"},"schema:ethdebug/format/program/instruction":{href:"/spec/program/instruction"},"schema:ethdebug/format/program/context":{href:"/spec/program/context"},...["code","variables","remark","pick","gather","frame"].map((e=>({[`schema:ethdebug/format/program/context/${e}`]:{href:`/spec/program/context/${e}`}}))).reduce(((e,t)=>({...e,...t})),{})},"schema:ethdebug/format/info":{href:"/spec/info"},"schema:ethdebug/format/info/resources":{href:"/spec/info/resources"}};var m=r(73584),d=r(87906),u=r(31085);function f(e){const{id:t,pointer:r,schema:n,yaml:s}=(0,h.hZ)(e),a=t?t.startsWith("schema:")?t.slice(7):t:void 0,i=a&&r?`${a}${r}`:a||void 0;return(0,u.jsxs)(c.default,{groupId:"schema-language",children:[(0,u.jsx)(l.default,{value:"yaml",label:"YAML",children:(0,u.jsx)(o(),{className:"schema-listing",language:"yaml",showLineNumbers:!0,title:i||"schema.yaml",children:s})}),(0,u.jsx)(l.default,{value:"json",label:"JSON",children:(0,u.jsx)(o(),{className:"schema-listing",language:"json",showLineNumbers:!0,title:i?`${i}`:"schema.json",children:JSON.stringify(n,void 0,2)})})]})}var y=r(86952),g=r(95500),x=r(75128),b=r.n(x),j=r(21805),v=r(77433),$=r.n(v);function w(e){const{schema:t}=(0,h.hZ)(e),{colorMode:r}=(0,g.G)(),s=t.examples?.[0]??{},a=(0,n.useRef)(null),i=(0,y.useMonaco)(),o=2,c=new($())({schemas:Object.values(h.jo),allErrors:!0,strict:!1}),[l,p]=(0,n.useState)(s),[m,d]=(0,n.useState)(!1);function f(e){console.error(e)}return(0,n.useEffect)((()=>{m&&function(){const t=c.getSchema(e.schema.id);if(!t)return f("Unable to validate schema");const r=function(){try{return b().parse(l,void 0,{tabWidth:o})}catch{return{data:"",pointers:{}}}}();t(r.data);const n=(0,j.L)({schema:h.jo[e.schema.id],data:r.data,errors:t.errors});console.log(n,t.errors),function(e,t){const r=a.current?.getModel();if(!r||!i)return f("Unable to validate schema");const n=[];if(e)for(const[s,a]of Object.entries(e)){const e=a.path.replace("{base}","").replace(/\./g,"/"),r=t.pointers[e];let s=a.message.replace("{base}","").replace(/\./g,"/");"const"==a.context.errorType&&(s=`Expecting a constant value of "${a.context.allowedValue}"`),r&&s&&(n.push({startLineNumber:r.value.line+1,startColumn:r.value.column+1,endColumn:r.valueEnd.column+1,endLineNumber:r.valueEnd.line+1,message:s,severity:i.MarkerSeverity.Error}),r.key&&r.keyEnd&&n.push({startLineNumber:r.key.line+1,startColumn:r.key.column+1,endColumn:r.keyEnd.column+1,endLineNumber:r.keyEnd.line+1,message:s,severity:i.MarkerSeverity.Error}))}i.editor.setModelMarkers(r,"EthDebug",n)}(n,r)}()}),[l]),(0,u.jsx)("section",{className:"playground-container",children:(0,u.jsx)(y.default,{height:"50vh",language:"json",theme:"dark"==r?"vs-dark":"vs-light",defaultValue:JSON.stringify(s,void 0,o),onChange:function(e){d(!0),p(e)},onMount:function(e){a.current=e},options:{contextmenu:!1,autoIndent:"advanced",tabSize:o}})})}function O(e){const t=(0,h.hZ)(e),{id:r,rootSchema:n,yaml:s,pointer:i}=t,y=k(n,r||"");return(0,u.jsxs)(c.default,{children:[(0,u.jsx)(l.default,{value:"viewer",label:"Explore",children:(0,u.jsx)(m.fn.Provider,{value:{rootSchemaInfo:t,schemaIndex:p},children:(0,u.jsx)(a(),{schema:y,resolverOptions:{jsonPointer:i,resolvers:{schema:{resolve:e=>{const t=e.toString(),{schema:r}=(0,h.hZ)({schema:{id:t}});return k(r,t)}}}},viewerOptions:{showExamples:!0,ValueComponent:({value:e})=>["string","number","bigint","boolean"].includes(typeof e)?(0,u.jsx)("code",{children:e.toString()}):(0,u.jsx)(o(),{language:"json",children:`${JSON.stringify(e,void 0,2)}`}),DescriptionComponent:({description:e})=>(0,u.jsx)(d.oz,{children:e})}})})}),(0,u.jsx)(l.default,{value:"listing",label:"View source",children:(0,u.jsx)(f,{schema:e.schema,pointer:e.pointer})}),(0,u.jsx)(l.default,{value:"playground",label:"Playground",children:(0,u.jsx)(w,{schema:e.schema,pointer:e.pointer})})]})}function k(e,t){return C(S(e),`${t}#`)}function C(e,t){return Array.isArray(e)?e.map(((e,r)=>C(e,`${t}/${r}`))):null!==e&&"object"==typeof e?Object.entries(e).reduce(((e,[r,n])=>(e[r]=C(n,`${t}/${r}`),e)),{[m._K]:t.endsWith("#")?t.slice(0,-1):t}):e}function S(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(S);if(1===Object.keys(e).length&&"$ref"in e)return e;const{$ref:t,...r}=e,n=Object.entries(r).reduce(((e,[t,r])=>(e[t]=S(r),e)),{});if(!t)return n;const s=["allOf","oneOf","anyOf"].find((t=>!(t in e)));if(!s)throw new Error(`Could not find available composition keyword in ${JSON.stringify(e)}`);return n[s]=[{$ref:t}],n}},73584(e,t,r){r.d(t,{_K:()=>i,fn:()=>s,wQ:()=>a});var n=r(14041);const s=(0,n.createContext)({schemaIndex:{}}),a=()=>(0,n.useContext)(s),i=Symbol("__$internalId")},99953(e,t,r){r.r(t),r.d(t,{default:()=>a});r(14041);var n=r(76947),s=r(31085);function a(e){const{schema:t}=e,r=void 0!==t.if,a=void 0!==t.dependentRequired,i=void 0!==t.dependentSchemas,o=void 0!==t.dependencies;return(0,s.jsxs)(s.Fragment,{children:[r&&(0,s.jsx)(n.IfElseThen,{schema:t}),a&&(0,s.jsx)(n.DependentRequired,{schema:t}),i&&(0,s.jsx)(n.DependentSchemas,{schema:t}),o&&(0,s.jsx)(n.Dependencies,{schema:t})]})}}}]);