"use strict";(globalThis.webpackChunk_ethdebug_format_web=globalThis.webpackChunk_ethdebug_format_web||[]).push([[5070],{87270(e,n,r){r.d(n,{A:()=>m});r(14041);var s=r(40665),i=r(54034),t=r.n(i);const a="container_eo8G",o="header_CGit",c="title_NhXp",l="schemaLink_R3qF",d="schemaName_hPpq",h="schemaLabel_TlZH";var p=r(31085);function m({schema:e,href:n,children:r,title:i}){const m="string"==typeof r?r:JSON.stringify(r,null,2),g=e.startsWith("ethdebug/format/")?e:`ethdebug/format/${e}`;return(0,p.jsxs)("div",{className:a,children:[(0,p.jsxs)("div",{className:o,children:[i&&(0,p.jsx)("span",{className:c,children:i}),(0,p.jsxs)(s.A,{to:n,className:l,children:[(0,p.jsx)("span",{className:h,children:"Schema:"}),(0,p.jsx)("span",{className:d,children:g})]})]}),(0,p.jsx)(t(),{language:"json",children:m})]})}},97629(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"getting-started/for-compiler-authors","title":"For compiler authors","description":"You\'re building a compiler or toolchain that produces EVM bytecode. Here\'s how","source":"@site/docs/getting-started/for-compiler-authors.mdx","sourceDirName":"getting-started","slug":"/getting-started/for-compiler-authors","permalink":"/format/docs/getting-started/for-compiler-authors","draft":false,"unlisted":false,"editUrl":"https://github.com/ethdebug/format/tree/main/packages/web/docs/getting-started/for-compiler-authors.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"For debugger authors","permalink":"/format/docs/getting-started/for-debugger-authors"},"next":{"title":"Overview","permalink":"/format/docs/concepts/"}}');var i=r(31085),t=r(71184),a=r(87270);const o={sidebar_position:3},c="For compiler authors",l={},d=[{value:"What you need to emit",id:"what-you-need-to-emit",level:2},{value:"Quick example: describing a type",id:"quick-example-describing-a-type",level:2},{value:"Quick example: describing a storage variable",id:"quick-example-describing-a-storage-variable",level:2},{value:"Integration approach",id:"integration-approach",level:2},{value:"Go deeper",id:"go-deeper",level:2},{value:"Explore by topic",id:"explore-by-topic",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"for-compiler-authors",children:"For compiler authors"})}),"\n",(0,i.jsxs)(n.p,{children:["You're building a compiler or toolchain that produces EVM bytecode. Here's how\nto emit ",(0,i.jsx)(n.strong,{children:"ethdebug/format"})," data so debuggers can provide rich debugging\nexperiences for your users."]}),"\n",(0,i.jsx)(n.h2,{id:"what-you-need-to-emit",children:"What you need to emit"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ethdebug/format"})," defines several kinds of debug information:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type information"})," \u2014 Describe the structure of data in your language\n(integers, structs, arrays, mappings)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pointer information"})," \u2014 Describe where variables are stored at runtime,\nincluding dynamic locations computed from other values"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Program information"})," \u2014 Describe what's in scope at each bytecode\ninstruction, mapping bytecode back to source code"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Info schema"})," \u2014 Bundle everything together with source files and\ncompilation metadata"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quick-example-describing-a-type",children:"Quick example: describing a type"}),"\n",(0,i.jsxs)(n.p,{children:["Here's how to describe a simple ",(0,i.jsx)(n.code,{children:"uint256"}),":"]}),"\n",(0,i.jsx)(a.A,{schema:"type/elementary/uint",href:"/spec/type/elementary/uint",title:"A uint256 type",children:'{\n  "kind": "uint",\n  "bits": 256\n}'}),"\n",(0,i.jsx)(n.p,{children:"A storage mapping from addresses to balances:"}),"\n",(0,i.jsx)(a.A,{schema:"type/complex/mapping",href:"/spec/type/complex/mapping",title:"An address \u2192 uint256 mapping",children:'{\n  "kind": "mapping",\n  "contains": {\n    "key": { "type": { "kind": "address" } },\n    "value": { "type": { "kind": "uint", "bits": 256 } }\n  }\n}'}),"\n",(0,i.jsx)(n.h2,{id:"quick-example-describing-a-storage-variable",children:"Quick example: describing a storage variable"}),"\n",(0,i.jsxs)(n.p,{children:["A pointer tells debuggers where to find a variable's value. For a ",(0,i.jsx)(n.code,{children:"uint256"}),"\nat storage slot 0:"]}),"\n",(0,i.jsx)(a.A,{schema:"pointer/region/storage",href:"/spec/pointer/region/location/storage",title:"A simple storage pointer",children:'{\n  "location": "storage",\n  "slot": "0x0",\n  "length": 32\n}'}),"\n",(0,i.jsxs)(n.p,{children:["For a dynamic array where the length is at slot 2 and elements start at\n",(0,i.jsx)(n.code,{children:"keccak256(2)"}),":"]}),"\n",(0,i.jsx)(a.A,{schema:"pointer/collection",href:"/spec/pointer/collection",title:"A dynamic array pointer",children:'{\n  "group": [\n    { "name": "array-length", "location": "storage", "slot": "0x2" },\n    {\n      "list": {\n        "count": { "$read": "array-length" },\n        "each": "i",\n        "is": {\n          "location": "storage",\n          "slot": {\n            "$sum": [{ "$keccak256": [{ "$wordsized": "0x2" }] }, "i"]\n          }\n        }\n      }\n    }\n  ]\n}'}),"\n",(0,i.jsx)(n.h2,{id:"integration-approach",children:"Integration approach"}),"\n",(0,i.jsxs)(n.p,{children:["Most compilers can add ",(0,i.jsx)(n.strong,{children:"ethdebug/format"})," support incrementally:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Start with types"})," \u2014 Emit type definitions for your language's data\nstructures. This can be a straightforward starting point."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Add storage pointers"})," \u2014 Describe where storage variables live. Many\nvariables have static locations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Add memory/stack pointers"})," \u2014 Describe temporary values. These often\nrequire tracking allocation during code generation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Add program information"})," \u2014 Emit source mappings and scope information.\nThis typically requires the most compiler changes."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"go-deeper",children:"Go deeper"}),"\n",(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col col--6",children:(0,i.jsxs)("div",{className:"card margin-bottom--md",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"Compiler implementation guide"})}),(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)(n.p,{children:["Detailed guidance on emitting ",(0,i.jsx)(n.strong,{children:"ethdebug/format"})," from your compiler."]})}),(0,i.jsx)("div",{className:"card__footer",children:(0,i.jsx)("a",{className:"button button--secondary button--block",href:"/docs/implementation-guides/compiler",children:(0,i.jsx)(n.p,{children:"Compiler guides \u2192"})})})]})}),(0,i.jsx)("div",{className:"col col--6",children:(0,i.jsxs)("div",{className:"card margin-bottom--md",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h4",{children:"Specification"})}),(0,i.jsx)("div",{className:"card__body",children:(0,i.jsxs)(n.p,{children:["Formal schema definitions for all ",(0,i.jsx)(n.strong,{children:"ethdebug/format"})," structures."]})}),(0,i.jsx)("div",{className:"card__footer",children:(0,i.jsx)("a",{className:"button button--secondary button--block",href:"/spec/overview",children:(0,i.jsx)(n.p,{children:"Read the spec \u2192"})})})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"explore-by-topic",children:"Explore by topic"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/core-schemas/types",children:"Types"})})," \u2014 Full documentation on type definitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/core-schemas/pointers",children:"Pointers"})})," \u2014 Full documentation on pointer definitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/core-schemas/programs",children:"Programs"})})," \u2014 Full documentation on program annotations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/core-schemas/info",children:"Info schema"})})," \u2014 Full documentation on bundling debug data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/examples/bug-playground",children:"BUG Playground"})})," \u2014 See a working\ncompiler that emits ",(0,i.jsx)(n.strong,{children:"ethdebug/format"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);