<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-implementation-guides/pointers/dereference-logic/generating-regions" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Generating regions on the fly | ethdebug format</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/generating-regions"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Generating regions on the fly | ethdebug format"><meta data-rh="true" name="description" content="The dereference() function internally creates an"><meta data-rh="true" property="og:description" content="The dereference() function internally creates an"><link data-rh="true" rel="icon" href="/format/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/generating-regions"><link data-rh="true" rel="alternate" href="https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/generating-regions" hreflang="en"><link data-rh="true" rel="alternate" href="https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/generating-regions" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Implementation guides","item":"https://ethdebug.github.io/format/docs/implementation-guides/"},{"@type":"ListItem","position":2,"name":"Dereferencing pointers","item":"https://ethdebug.github.io/format/docs/implementation-guides/pointers/"},{"@type":"ListItem","position":3,"name":"The dereference function","item":"https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/"},{"@type":"ListItem","position":4,"name":"Generating regions on the fly","item":"https://ethdebug.github.io/format/docs/implementation-guides/pointers/dereference-logic/generating-regions"}]}</script><link rel="stylesheet" href="/format/assets/css/styles.7b0c8c20.css">
<script src="/format/assets/js/runtime~main.ef6639bf.js" defer="defer"></script>
<script src="/format/assets/js/main.9515049a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/format/"><div class="navbar__logo"><img src="/format/img/logo.svg" alt="ethdebug logo" class="themedComponent_DHUr themedComponent--light_DIHH"><img src="/format/img/logo.svg" alt="ethdebug logo" class="themedComponent_DHUr themedComponent--dark_Bv2M"></div><b class="navbar__title text--truncate">ethdebug format</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/format/docs/overview">Documentation</a><a class="navbar__item navbar__link" href="/format/spec/overview">Specification</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link status-indicator" href="/format/status">Status: Draft</a><a href="https://github.com/ethdebug/format" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_KEbZ systemToggleIcon_txm5"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_bmvg"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_UyTV"><div class="docsWrapper_XLvK"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docRoot_HciC"><aside class="theme-doc-sidebar-container docSidebarContainer_e5ai"><div class="sidebarViewport_N8x0"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/format/docs/overview"><span title="Project overview" class="linkLabel_PuAu">Project overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" href="/format/docs/getting-started/"><span title="Getting started" class="categoryLinkLabel_Oe72">Getting started</span></a><button aria-label="Expand sidebar category &#x27;Getting started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" href="/format/docs/concepts/"><span title="Concepts" class="categoryLinkLabel_Oe72">Concepts</span></a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/format/docs/core-schemas/types/"><span title="Core schemas" class="categoryLinkLabel_Oe72">Core schemas</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--active" href="/format/docs/implementation-guides/"><span title="Implementation guides" class="categoryLinkLabel_Oe72">Implementation guides</span></a><button aria-label="Collapse sidebar category &#x27;Implementation guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--active" tabindex="0" href="/format/docs/implementation-guides/pointers/"><span title="Dereferencing pointers" class="categoryLinkLabel_Oe72">Dereferencing pointers</span></a><button aria-label="Collapse sidebar category &#x27;Dereferencing pointers&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/format/docs/implementation-guides/pointers/types/"><span title="Essential type definitions" class="categoryLinkLabel_Oe72">Essential type definitions</span></a><button aria-label="Expand sidebar category &#x27;Essential type definitions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/format/docs/implementation-guides/pointers/reading-from-regions"><span title="Reading from pointer regions" class="linkLabel_PuAu">Reading from pointer regions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/format/docs/implementation-guides/pointers/evaluating-expressions"><span title="Evaluating pointer expressions" class="linkLabel_PuAu">Evaluating pointer expressions</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--active" tabindex="0" href="/format/docs/implementation-guides/pointers/dereference-logic/"><span title="The dereference function" class="categoryLinkLabel_Oe72">The dereference function</span></a><button aria-label="Collapse sidebar category &#x27;The dereference function&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/format/docs/implementation-guides/pointers/dereference-logic/generating-regions"><span title="Generating regions on the fly" class="linkLabel_PuAu">Generating regions on the fly</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/format/docs/implementation-guides/pointers/dereference-logic/making-regions-concrete"><span title="Making regions concrete" class="linkLabel_PuAu">Making regions concrete</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/format/docs/implementation-guides/pointers/testing/"><span title="End-to-end testing" class="categoryLinkLabel_Oe72">End-to-end testing</span></a><button aria-label="Expand sidebar category &#x27;End-to-end testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" tabindex="0" href="/format/docs/implementation-guides/compiler/"><span title="Compiler Guides" class="categoryLinkLabel_Oe72">Compiler Guides</span></a><button aria-label="Expand sidebar category &#x27;Compiler Guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist" href="/format/docs/examples/"><span title="Examples" class="categoryLinkLabel_Oe72">Examples</span></a><button aria-label="Expand sidebar category &#x27;Examples&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_d9ci menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/format/docs/reference/goals"><span title="Reference" class="categoryLinkLabel_Oe72">Reference</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_namt"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/format/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/format/docs/implementation-guides/"><span>Implementation guides</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/format/docs/implementation-guides/pointers/"><span>Dereferencing pointers</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/format/docs/implementation-guides/pointers/dereference-logic/"><span>The dereference function</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Generating regions on the fly</span></li></ul></nav><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Generating regions on the fly</h1></header>
<p>The <code>dereference()</code> function internally creates an
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncIterator" target="_blank" rel="noopener noreferrer" class="">AsyncIterator<!-- -->ï»¿<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a>
to produce an asynchronous list of regions.</p>
<p>The process to produce this list uses a stack of processing requests (which
it calls &quot;memos&quot;), consuming one memo at a time from the top of the stack
and handling it based on what kind of memo it is.</p>
<p>This is defined by the <code>generateRegions()</code> function (defined in conjunction
with <code>GenerateRegionsOptions</code>):</p>
<details class="details_B4FW alert alert--info details_SZgV" data-collapsed="true"><summary><code>generateRegions()</code> and <code>GenerateRegionsOptions</code></summary><div><div class="collapsibleContent_VYua"><div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * Upfront information needed for generating the concrete Cursor.Regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * for a particular pointer at runtime.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">GenerateRegionsOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Templates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Machine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  initialStackLength</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div><div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * Generator function that yields Cursor.Regions for a given Pointer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * This function maintains an internal stack of memos to evaluate,</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * initially populating this stack with a single entry for evaluating the</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * given pointer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateRegions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pointer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  generateRegionsOptions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> GenerateRegionsOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> AsyncIterable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Cursor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">initializeProcessOptions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">generateRegionsOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// extract records for mutation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> regions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> variables </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Stack of rename mappings for template references with yields</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renameStack</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Stack of template definitions for inline templates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> templatesStack</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Templates</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> stack</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dereferencePointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pointer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">stack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> memo</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Memo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> stack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> memos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dereference-pointer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Merge inline templates with base templates (inline takes precedence)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> currentTemplates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> templatesStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">reduce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> templates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">acc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">templates </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">templates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Process the pointer, intercepting yielded regions to apply renames</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> process </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processPointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          templates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> currentTemplates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">done</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> region </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Apply rename if in context and region has a name in mapping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> currentMapping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> renameStack</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">renameStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentMapping </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> currentMapping</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newName </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> newName </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              region </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> newName </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        memos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-regions&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">regions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Save under original name for internal reference resolution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          regions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-variables&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">assign</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">variables</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">variables</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-region-renames&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        renameStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mapping</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-region-renames&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Apply renames when exiting the context: add mappings from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// original names to new names for external reference resolution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mapping </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> renameStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mapping</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">originalName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newName</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mapping</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">originalName </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> regions </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> newName </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> originalName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              regions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">newName</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">regions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">originalName</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> newName </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-templates&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        templatesStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">templates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-templates&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        templatesStack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// add new memos to the stack in reverse order</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> memos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">--</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memos</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div></div></div></details>
<p>Notice how this function initializes two mutable records collections: one for
all the current named regions, and one for all the current variables. As
this function&#x27;s <code>while()</code> loop operates on the stack, memos for saving new
named regions or updating variable values may appear and then get handled
appropriately.</p>
<p>For reference, see the <code>memo.ts</code> module for type definitions for each of the
three types of memo and their corresponding helper constructor functions.</p>
<details class="details_B4FW alert alert--info details_SZgV" data-collapsed="true"><summary>See the <code>memo.ts</code> module</summary><div><div class="collapsibleContent_VYua"><div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_L5qy">src/dereference/memo.ts</div><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo codeBlockLinesWithNumbering_p5De" style="counter-reset:line-count 0"><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Pointer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@ethdebug/format&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Cursor </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;#cursor&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Data </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;#data&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * A single state transition for processing on a stack</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Memo</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DereferencePointer</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SaveRegions</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SaveVariables</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PushRegionRenames</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PopRegionRenames</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PushTemplates</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PopTemplates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">namespace</span><span class="token plain"> Memo </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to dereference a pointer</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">DereferencePointer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dereference-pointer&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    pointer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a DereferencePointer memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> dereferencePointer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pointer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> DereferencePointer </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dereference-pointer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to modify the stateful map of regions by name with a</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * particular set of new entries.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   *</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * This does not indicate that any change should be made to region names not</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * included in this memo.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">SaveRegions</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-regions&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    regions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Cursor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a SaveRegions memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> saveRegions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    regions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Cursor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> SaveRegions </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-regions&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    regions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to modify the stateful map of variable values with a</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * particular set of new entries.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   *</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * This does not indicate that any change should be made to variables not</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * included in this memo.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">SaveVariables</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-variables&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a SaveVariables memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> saveVariables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> SaveVariables </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;save-variables&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    variables</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to push a region rename mapping onto the context stack.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * While active, regions with names in the mapping will be saved under</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * both their original name (for internal references) and their new name</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * (for external references after the template).</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">PushRegionRenames</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-region-renames&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    mapping</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a PushRegionRenames memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pushRegionRenames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    mapping</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> PushRegionRenames </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-region-renames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    mapping</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to pop the current region rename mapping from the context stack.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">PopRegionRenames</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-region-renames&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a PopRegionRenames memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> popRegionRenames </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> PopRegionRenames </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-region-renames&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to push template definitions onto the context stack.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * While active, these templates are available for use by reference</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * collections.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">PushTemplates</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-templates&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    templates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Templates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a PushTemplates memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pushTemplates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    templates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Templates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> PushTemplates </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;push-templates&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    templates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * A request to pop the current template definitions from the context stack.</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">PopTemplates</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-templates&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   * Initialize a PopTemplates memo</span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token doc-comment comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> popTemplates </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> PopTemplates </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">    kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pop-templates&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_DPDv" style="color:#393A34"><span class="codeLineNumber_YxQB"></span><span class="codeLineContent_SOIp"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span><br></span></code></pre></div></div></div></div></details>
<p>The real bulk of what <code>generateRegions()</code> does, however, is hidden inside the
call <code>yield* processPointer()</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="processing-a-pointer">Processing a pointer<a href="#processing-a-pointer" class="hash-link" aria-label="Direct link to Processing a pointer" title="Direct link to Processing a pointer" translate="no">â</a></h2>
<p>To handle a <code>DereferencePointer</code> memo from the stack inside
<code>generateRegions()</code>, it defers to the <code>processPointer()</code> generator function.</p>
<p>The signature of this function and associated types are as follows:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * Process a pointer into a yielded list of concrete, evaluated Cursor.Regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * and return a list of new memos to add to the stack for processing next</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">declare</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processPointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pointer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The <code>ProcessOptions</code> interface captures the runtime data at a particular
point in the region generation process:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * Contextual information for use within a pointer dereference process</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">ProcessOptions</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  templates</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Templates</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Machine</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  stackLengthChange</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bigint</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  regions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Cursor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Record</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Data</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The <code>Process</code> type alias provides a short type alias for functions like
<code>processPointer</code> to use:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * an generator that yields Cursor regions and returns a list of new memos</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * to add to the stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Process</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> AsyncGenerator</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Cursor</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Effectively, by returning a <code>Process</code>, the <code>processPointer()</code> has two
different mechanisms of data return:</p>
<ul>
<li class="">By being a JavaScript <code>AsyncGenerator</code>, it produces <code>Cursor.Region</code> objects
one at a time, emitted as a side effect of execution (via JavaScript <code>yield</code>)</li>
<li class="">Upon completion of exection, the return value is a list of memos to be
added to the stack.</li>
</ul>
<p><strong>Note</strong> that the expected behavior for this implementation is that the
returned list of memos should be pushed onto the stack in reverse order,
so that earlier memos in the list will be processed before later ones.</p>
<details class="details_B4FW alert alert--info details_SZgV" data-collapsed="true"><summary>See the full definition of <code>processPointer()</code></summary><div><div class="collapsibleContent_VYua"><div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * Process a pointer into a yielded list of concrete, evaluated Cursor.Regions</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> * and return a list of new memos to add to the stack for processing next</span><br></span><span class="token-line" style="color:#393A34"><span class="token doc-comment comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processPointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pointer</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isRegion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pointer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> region </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processRegion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> collection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pointer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isGroup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processGroup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isConditional</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processConditional</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isScope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processScope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isReference</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processReference</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isTemplates</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">yield</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processTemplates</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pointer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unexpected unknown kind of pointer&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div></div></div></details>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="processing-a-region">Processing a region<a href="#processing-a-region" class="hash-link" aria-label="Direct link to Processing a region" title="Direct link to Processing a region" translate="no">â</a></h2>
<p>The simplest kind of pointer is just a single region. (Remember that pointers
are either regions or collections of other pointers.)</p>
<p>There is complexity hidden by function calls here, but nonetheless first
consider the implementation of the <code>processRegion()</code> function as a base case:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processRegion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  region</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Region</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> stackLengthChange</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">options </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> evaluatedRegion </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">evaluateRegion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">adjustStackLength</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stackLengthChange</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"> evaluatedRegion</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> region</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;undefined&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveRegions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">region</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> evaluatedRegion </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Effectively, this function converts a <code>Pointer.Region</code> into a
fully-evaluated, concrete <code>Cursor.Region</code>, emits this concrete region as the
next <code>yield</code>ed value in the asynchronous list of regions, and possibly issues
a request to save this region to process state by its name.</p>
<p>This pointer evaluation process will be described later.</p>
<h2 class="anchor anchorTargetStickyNavbar_SAay" id="processing-collections">Processing collections<a href="#processing-collections" class="hash-link" aria-label="Direct link to Processing collections" title="Direct link to Processing collections" translate="no">â</a></h2>
<p>The recursive cases are fairly straightforward following this architecture.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="groups">Groups<a href="#groups" class="hash-link" aria-label="Direct link to Groups" title="Direct link to Groups" translate="no">â</a></h3>
<p>The simplest collection, a group of other pointers, yields no regions of its
own, but instead pushes each of its child pointers for evaluation later:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processGroup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  collection</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  _options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> group </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> group</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dereferencePointer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>It&#x27;s essential that each of the child pointers get evaluated in the order
they appear in the list, since later pointers may reference regions named
earlier, etc.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="lists">Lists<a href="#lists" class="hash-link" aria-label="Direct link to Lists" title="Direct link to Lists" translate="no">â</a></h3>
<p>List collections are more complex because they dynamically generate a number
of composed pointers based on a runtime count value and introducing a
variable identifier for use inside the dynamic composed pointer evaluation.</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  collection</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">List</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> list </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> count</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> countExpression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> each</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> list</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">countExpression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asUint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> memos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0n</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> count</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> index</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    memos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">each</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fromUint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    memos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dereferencePointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">is</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> memos</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Note how, because each dynamic child pointer is evaluated based on the
next incremented index value, the memos for updating this variable and
evaluation the child pointer must be interspersed.</p>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="conditionals">Conditionals<a href="#conditionals" class="hash-link" aria-label="Direct link to Conditionals" title="Direct link to Conditionals" translate="no">â</a></h3>
<p>Conditional pointers evaluate to a child pointer given that some runtime
condition evaluates to a nonzero value, optionally evaluating to a different
pointer when that conditional fails.</p>
<p>Evaluating a conditional thus becomes a simple matter of evaluating the
<code>&quot;if&quot;</code> clause and issuing a memo for dereferencing the <code>&quot;then&quot;</code> pointer or
the <code>&quot;else&quot;</code> pointer if it is specified:</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processConditional</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  collection</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Conditional</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ifExpression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> then</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> then_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> else_ </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> if_ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ifExpression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asUint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">if_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dereferencePointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">then_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// otherwise, return the else clause if it exists (it is optional)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> else_ </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dereferencePointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">else_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_SAay" id="scopes">Scopes<a href="#scopes" class="hash-link" aria-label="Direct link to Scopes" title="Direct link to Scopes" translate="no">â</a></h3>
<p>Finally, the last kind of collection defined by this schema is for defining
a scope of variables by identifier by specifying the expression values for
each of those variables.</p>
<p>Since this schema takes advantage of how JSON objects are ordered lists of
key/value pairs, variables specified later may reference variables specified
earlier. The only trickiness in implementing <code>processScope</code> is ensuring that
variable values are available immediately.</p>
<div class="language-typescript codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kX1v"><pre tabindex="0" class="prism-code language-typescript codeBlock_TAPP thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">processScope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  collection</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Pointer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Scope</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ProcessOptions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Process </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> define</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> variableExpressions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> in_ </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> allVariables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">variables</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newVariables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">identifier</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Data </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">identifier</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> expression</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">of</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">variableExpressions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">expression</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> allVariables</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    allVariables</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">identifier</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    newVariables</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">identifier</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">saveVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">newVariables</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Memo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">dereferencePointer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">in_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_HJkF"><a href="https://github.com/ethdebug/format/tree/main/packages/web/docs/implementation-guides/pointers/dereference-logic/generating-regions.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_g62E"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/format/docs/implementation-guides/pointers/dereference-logic/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">The dereference function</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/format/docs/implementation-guides/pointers/dereference-logic/making-regions-concrete"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Making regions concrete</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#processing-a-pointer" class="table-of-contents__link toc-highlight">Processing a pointer</a></li><li><a href="#processing-a-region" class="table-of-contents__link toc-highlight">Processing a region</a></li><li><a href="#processing-collections" class="table-of-contents__link toc-highlight">Processing collections</a><ul><li><a href="#groups" class="table-of-contents__link toc-highlight">Groups</a></li><li><a href="#lists" class="table-of-contents__link toc-highlight">Lists</a></li><li><a href="#conditionals" class="table-of-contents__link toc-highlight">Conditionals</a></li><li><a href="#scopes" class="table-of-contents__link toc-highlight">Scopes</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/format/docs/overview">Project overview</a></li><li class="footer__item"><a class="footer__link-item" href="/format/docs/reference/challenges">Known challenges</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Spec</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/format/spec/overview">Specification overview</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://matrix.to/#/#ethdebug:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix.chat<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/ethdebug" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/ethdebug/format" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_awgD"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 by ethdebug contributors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>